<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>nuFood</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
    <meta name="description" content="Northwestern students: find dining hall food near you.">
    <meta name="author" content="">

    <!-- Styles -->
    <link href="/static/bootstrap/css/bootstrap.css" rel="stylesheet">
    <style>
    
body { padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */ }
      
.btn-hall {
    display: block;
    width: 90%;
    font-size: 14px;
    padding-left: 7px;
    padding-right: 7px;
   /* padding: 0px; */
    
    color: #ffffff;
    text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.25);
    background-color: #49afcd;
    *background-color: #2f96b4;
    background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#5bc0de), to(#2f96b4));
    background-image: -webkit-linear-gradient(top, #5bc0de, #2f96b4);
    background-image: -o-linear-gradient(top, #5bc0de, #2f96b4);
    background-image: linear-gradient(to bottom, #5bc0de, #2f96b4);
    background-image: -moz-linear-gradient(top, #5bc0de, #2f96b4);
    background-repeat: repeat-x;
    border-color: #2f96b4 #2f96b4 #1f6377;
    border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);
    filter: progid:dximagetransform.microsoft.gradient(startColorstr='#ff5bc0de', endColorstr='#ff2f96b4', GradientType=0);
    filter: progid:dximagetransform.microsoft.gradient(enabled=false);
}


.btn-hall:hover,
.btn-hall:active,
.btn-hall.active,
.btn-hall.disabled,
.btn-hall[disabled] {
    color: #ffffff;
    background-color: #2f96b4;
    *background-color: #2a85a0;
}


.btn-hall.active { background-color: #24748c \9; }


h1 {font-size: 18pt;}

/*.hall-listing {padding: 2px; margin: 0 auto;}*/

.hall-name {
    width: 60%;
    display:inline-block;
    text-align: left;
}

.hours-info {
    text-align: right;
    font-size: 9pt;
}      

.open { 
    background-color: green;
}

.closed {
    background-color: red;
}

</style>
    <link href="/static/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    
<script>
/* Name:    displayTime
 * Purpose: display the opening/closing time of a dining location in 12hr format
            if dining location is opening/closing soon, displays minutes left
 * Params:  an int hour and min, whether the dining location is open now
 * Returns: the time in string format
 */
function displayTime(hour, min, isOpen) {
    
    // If time left open/close is less than this many minutes,
    // the hall is deemed to be changing state "soon"
    var soonLimit = 30;
    
    // getting this from .py file for testing for now
    // var now = new Date(); 
    
    var hourNow = {{nowHr}}; // now.getHours();
    var minNow ={{nowMin}};  // now.getMinutes();
    
    timeLabelStr = "closes at ";
    if (!isOpen) timeLabelStr = "opens at ";
    
    // calculate difference between current time and given time
    // diff = given-current  to calculate time left open
    // diff = current-given  to calculate time until open (or x -1)
    var timeDiff = (hour*60+min)-(hourNow*60+minNow);
    
    // dining location is closing soon
    if( isOpen & timeDiff>0 & timeDiff<soonLimit )
        return "closes in "+timeDiff+" min";
        
    timeDiff = timeDiff*-1;

    // dining location is opening soon
    if ( !isOpen & timeDiff>0 & timeDiff<soonLimit)
        return "opens in "+timeDiff+" min";
   
    // Javascript allows you to change variable type, int to string here
    if (min < 10) min = "0"+min;

    // Modulo operator in case hour is 24 or above.
    hour = hour % 24;

    // Subtract 12 for 12 hour display, instead of 24hr 
    if (hour > 12) {
        hour = hour-12;
        return  timeLabelStr+hour+":"+min+"pm";
    }
    
    // Display midnight correctly
    if (hour==0) { hour = 12; }
    
    return timeLabelStr+hour+":"+min+"am";
}

</script>

    <!-- Le fav and touch icons
    <link rel="shortcut icon" href="../assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
    -->
  </head>


  <body>
    <!-- Nav bar -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#">nuFood</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="active"><a href="#">Home</a></li>
              <!-- About and contact pages not built
              <li><a href="/about">About</a></li>
              <li><a href="/contact">Contact</a></li>-->
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <!-- Dining hall list -->
    <div class="container">
    
        <!-- <h1>Dining Locations</h1> 
        
        <div id="test1"> test div 1</div>
        <div id="test2"> test div 2</div> -->
        <h5>
        Current time: <!--{{nowHr}}:{{nowMin|stringformat:"02d"}}-->
        {% if nowHr > 12 %}
        {{nowHr|add:"-12"}}:{{nowMin|stringformat:"02d"}} pm
        {% elif nowHr == 12 %}
        {{nowHr}}:{{nowMin|stringformat:"02d"}} pm
        {% elif nowHr == 0 %}
        {{nowHr}}:{{nowMin|stringformat:"02d"}} am
        {% else %}
        {{ nowHr|stringformat:"02d" }}:{{ nowMin|stringformat:"02d"}} am
        {% endif %}
        </h5>
        <p>
        {% for hour in openHalls %}
        <!-- somehow create int i = 0… or have a hall id? -->
        <div class="hall-listing"> 
        <a class="btn btn-hall btn-large open"> 
        <!-- if hour.mealtype == ret, then add an id or something -->
        <span class="hall-name"> {{ hour.host_hall }} </span>
        <span class="hours-info"> <!--id="hall+i"-->
        <!--
        closes at
        -->
        <!-- i think this is poor form (embedding script inside the main html, but i don't know how to call this function properly… i think if we had unique id #'s for halls, we would have unique document id's to write to, and could do that in an initialize function onload…? -->
        <script>
        document.write(displayTime({{hour.end_hour}}, {{hour.end_minute}}, true));
        </script>
        </span>
        </a>
        </div> 
        {% endfor %}
        </p>
        
        <p>
        {% for hour in closedHalls %}
        <div class="hall-listing">
        <a class="btn btn-hall btn-large closed">
        <span class="hall-name"> {{ hour.host_hall }} </span>
        <span class="hours-info">
        <!--
        opens at
        -->
        <script>
        document.write(displayTime({{hour.start_hour}}, {{hour.start_minute}}, false));
        </script>
        </span>
        </a>
        </div> 
        {% endfor %}
        </p>
        
        
        
    </div> <!-- /container -->
    
        

    <!-- Javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/static/bootstrap/js/jquery.js"></script>
    <script src="/static/bootstrap/js/bootstrap-transition.js"></script>
    <script src="/static/bootstrap/js/bootstrap-alert.js"></script>
    <script src="/static/bootstrap/js/bootstrap-modal.js"></script>
    <script src="/static/bootstrap/js/bootstrap-dropdown.js"></script>
    <script src="/static/bootstrap/js/bootstrap-scrollspy.js"></script>
    <script src="/static/bootstrap/js/bootstrap-tab.js"></script>
    <script src="/static/bootstrap/js/bootstrap-tooltip.js"></script>
    <script src="/static/bootstrap/js/bootstrap-popover.js"></script>
    <script src="/static/bootstrap/js/bootstrap-button.js"></script>
    <script src="/static/bootstrap/js/bootstrap-collapse.js"></script>
    <script src="/static/bootstrap/js/bootstrap-carousel.js"></script>
    <script src="/static/bootstrap/js/bootstrap-typeahead.js"></script>

  </body>
</html>